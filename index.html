<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>倒计时生成对联</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            background-color: #f9f9f9;
            display: flex;
            justify-content: center;
            align-items: center;
            flex-direction: column;
        }
    
        .container {
            display: flex;
            flex-direction: column;
            width: 90%;
            max-width: 1200px;
            margin: 20px;
        }
    
        @media (min-width: 768px) {
            .container {
                flex-direction: row;
            }
            .countdown-left, .countdown-right {
                width: 200px;
            }
            .countdown-left h1, .countdown-right h1 {
                font-size: 2rem;
                padding: 5px;
            }
            .my-left{
                width: 40%;
            }
            .content{
                margin-left: 10px;
            }
        }
        
        .countdown {
            display: flex;
            justify-content: space-between;
            color: white;
            padding: 1px;
            text-align: center;
            border-radius: 8px;
            height: 35%;
            background-color: transparent;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
    
        .countdown-left, .countdown-right {
            flex: 1;
            padding: 20px;
            margin: 0;
            display: flex;
            align-items: center;
            justify-content: center;
            text-align: center;
        }
    
        .countdown-left {
            background-color: #ebebeb;
            border-top-left-radius: 8px;
            border-bottom-left-radius: 8px;
            color: #000;
        }
    
        .countdown-right {
            background-color: #d01c10;
            border-top-right-radius: 8px;
            border-bottom-right-radius: 8px;
        }
    
        .countdown h1 {
            font-size: 50px;
        }
    
        .content {
            flex: 2;
            background: #fff;
            border: 1px solid #ddd;
            border-radius: 8px;
            padding: 20px;
            display: flex;
            flex-direction: column;
        }
        
    
        .form input, .form select {
            width: 100%;
            padding: 10px;
            margin: 10px 0;
            border: 1px solid #ccc;
            border-radius: 4px;
        }
    
        .form button {
            background: #e84118;
            color: white;
            border: none;
            padding: 12px;
            margin-top: 6px;
            cursor: pointer;
            font-size: 16px;
            width: 100%;
            border-radius: 5px;
        }
        input, select {
            box-sizing: border-box;
            width: 100%;
        }
        .countdown-description {
            margin-top:12px;
        }
        .gallery {
            display: flex;
            flex-wrap: wrap;
            gap: 12px;
            padding: 5px;
            margin: 5px;
        }
    
        .gallery img {
            width: 48%;
            border-radius: 8px;
        }
        
        /* 使模态窗口背景半透明 */
        .modal {
            display: none; /* 默认隐藏 */
            position: fixed;
            z-index: 1;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7);
            justify-content: center;
            align-items: center;
        }
        
        /* 弹窗关闭按钮样式 */
        .close {
            position: absolute;
            top: 15px;
            right: 25px;
            color: white;
            font-size: 30px;
            font-weight: bold;
            cursor: pointer;
        }
        
        /* 模态窗口中显示的图片 */
        .modal-content {
            max-width: 90%;
            max-height: 90%;
        }
        /* 弹出框样式 */
        .modal-img {
          display: none;
          position: fixed;
          top: 0;
          left: 0;
          width: 100%;
          height: 100%;
          background-color: rgba(0, 0, 0, 0.5);
          justify-content: center;
          align-items: center;
        }
        
        .modal-img-content {
          background-color: #fff;
          padding: 20px;
          border-radius: 5px;
          text-align: center;
          font-size: 18px;
        }
    </style>
    
</head>
<body>
    <div class="container">
        <div class="my-left">
            <div class="countdown">
                <div class="countdown-left">
                    <h1>距离<br/>过年</h1>
                </div>
                <div class="countdown-right">
                    <h1>还有<br/><span id="days-remaining"></span>天</h1>
                </div>
            </div>
             <!-- 新添加的 div -->
            <div class="countdown-description">
                
            <div class="gallery">
                <!-- 图片集合 -->
                <img src="https://p11-stone-ui-builder-sign.byteimg.com/tos-cn-i-e1ww11ta6z/picture/1858623821844992_1734235587766907762.png~tplv-e1ww11ta6z-normal.webp?rk3s=daacf5c7&x-expires=1743656508&x-signature=mZ2xUcyXqmYxsQErfDFCJBPw%2FCc%3D" alt="对联样例1" class="thumbnail" onclick="openModal(this)">
                <img src="https://p3-official-plugin-sign.byteimg.com/tos-cn-i-5jbd59dj06/c61009d5204b4ce587d994f2f04c2430~tplv-5jbd59dj06-image.png?lk3s=8c875d0b&x-expires=1767420655&x-signature=nflZzC0oSLWHqzujVuxTgINwovs%3D" alt="对联样例2" class="thumbnail" onclick="openModal(this)">
                <img src="https://p26-stone-ui-builder-sign.byteimg.com/tos-cn-i-e1ww11ta6z/picture/1858623821844992_1734235613806156211.png~tplv-e1ww11ta6z-normal.webp?rk3s=daacf5c7&x-expires=1743656351&x-signature=dQTsDTb%2BWHOPxCjNlcuy6WNm7jI%3D" alt="对联样例3" class="thumbnail" onclick="openModal(this)">
                <img src="https://p26-stone-ui-builder-sign.byteimg.com/tos-cn-i-e1ww11ta6z/picture/1858623821844992_1734185972622403617.png~tplv-e1ww11ta6z-normal.webp?rk3s=daacf5c7&x-expires=1743656351&x-signature=E8ZWpZ1YWzns4DF8OGe73E2hbyw%3D" alt="对联样例4" class="thumbnail" onclick="openModal(this)">
                
                <!-- 模态弹窗 -->
                <div id="imageModal" class="modal">
                    <span class="close" onclick="closeModal()">&times;</span>
                    <img class="modal-content" id="modalImage">
                </div>
            </div>
            </div>
        </div>
        <div class="content">
            <div class="form">
                <h2>你的名字就是春联</h2>
                <p>独一无二的春联属于亿中无一的你</p>
                <label for="name">请输入姓名</label>
                <input type="text" id="name" placeholder="黄啊码">

                <label for="style">请选择风格</label>
                <select id="style">
                    <option value="羊毛毡" selected>羊毛毡风格</option>
                    <option value="艺术">艺术风格</option>
                </select>

                <button onclick="generateCouplet()">生成对联</button>
                
                <img onclick="openModal(this)" src="data:image/png;base64,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" id="content_img" style="width: 100%;border-radius: 8px;margin-top: 14px;">
            </div>
        </div>
        <!-- 生成提示框 -->
        <div id="loadingModal" class="modal-img">
            <div class="modal-img-content">
            <p>正在生成，请稍候...</p>
            </div>
        </div>
    </div>

    <script>
        // 打开模态窗口并显示点击的图片
        function openModal(imgElement) {
            var modal = document.getElementById("imageModal");
            var modalImg = document.getElementById("modalImage");
            
            // 设置模态窗口图片为点击的图片
            modal.style.display = "flex";
            modalImg.src = imgElement.src;
        }
        
        // 关闭模态窗口
        function closeModal() {
            var modal = document.getElementById("imageModal");
            modal.style.display = "none";
        }
        function calculateDaysRemaining() {
            // 获取当前年份
            const currentYear = new Date().getFullYear();

            // 创建一个 Date 对象，表示当前年份的春节日期
            // 需要根据当前年份动态设置春节的日期
            const chineseNewYear = new Date(currentYear, 0, 29); // 假设春节为 1 月 29 日，实际需要根据年份来确定

            // 获取当前日期
            const today = new Date();

            // 计算当前年份春节的时间差（以毫秒为单位）
            const timeDifference = chineseNewYear - today;

            // 将时间差转换为天数
            const daysRemaining = Math.ceil(timeDifference / (1000 * 60 * 60 * 24));

            document.getElementById('days-remaining').textContent = `${daysRemaining}`;
        }

        function generateCouplet() {
            // 获取用户输入的姓名和选择的风格
            const name = document.getElementById('name').value;
            const style = document.getElementById('style').value;
        
            if (!name || !style) {
                alert('请输入姓名并选择风格！');
                return;
            }
        
            // 显示“正在生成”提示框
            document.getElementById('loadingModal').style.display = 'flex';
        
            const url = 'https://api.coze.cn/v1/workflow/run';
            const token = 'pat_cLahHo7AQpfNQaG2zcut8xPGVQRYJYdZbP2pGIBsw9gFXNj92Jg6VQfOiizbjwWO';
        
            const payload = {
                parameters: {
                    username: name,
                    style: style
                },
                workflow_id: "7455515820271550516"
            };
        
            const xhr = new XMLHttpRequest();
            xhr.open('POST', url, true);
            xhr.setRequestHeader('Authorization', `Bearer ${token}`);
            xhr.setRequestHeader('Content-Type', 'application/json');
        
            xhr.onreadystatechange = function () {
                if (xhr.readyState === 4) {
                    // 请求完成，隐藏“正在生成”提示框
                    document.getElementById('loadingModal').style.display = 'none';
        
                    if (xhr.status >= 200 && xhr.status < 300) {
                        try {
                            const response = JSON.parse(xhr.responseText);
                            if (response.code === 0 && response.data) {
                                const parsedData = JSON.parse(response.data); // 解析 `data` 字段中的 JSON 字符串
                                const imageUrl = parsedData.output; // 获取 `output` 字段
                                const contentImg = document.getElementById('content_img');
                                contentImg.src = imageUrl;
                            } else {
                                console.error('Error in response data:', response);
                                alert('生成对联失败，请稍后重试！');
                            }
                        } catch (error) {
                            console.error('Error parsing response:', error);
                            alert('生成对联失败，请稍后重试！');
                        }
                    } else {
                        console.error('Request failed:', xhr.status, xhr.statusText);
                        alert('生成对联失败，请稍后重试！');
                    }
                }
            };
        
            xhr.send(JSON.stringify(payload));
        }
        // 初始化
        calculateDaysRemaining();
    </script>
</body>
</html>
